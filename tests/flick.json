{
  "packages": {
    "express": "3.4.4",
    "ejs": "0.8.5",
    "flickr": "0.1.0",
    "mongoose": "3.8.1"
  },
  "modules": {
    "custom": {
      "custom.txt": "this is custom code\n"
    },
    "public": {
      "models.js": "/*\n * models.js\n * remote method library\n *\n * by Appcubator, all rights reserved\n *\n */\n\n\nwindow.models = (function($, modelDefs){\n\n    var remoteFnFactory = function(method, url) {\n        var remoteFn = function() {\n            // read more at https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/arguments\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop(); // this would be the last argument\n\n            $.ajax({\n                url: url,\n                method: method,\n                data: JSON.stringify(args),\n                contentType: 'application/json',\n                success: function(res) {callback(res.error, res.data);}\n            });\n        };\n        return remoteFn;\n    };\n\n    var models = {};\n\n    /* initialize model object with an attribute for each model, for each model method. */\n    for (var modelName in modelDefs) {\n        var modelDef = modelDefs[modelName];\n        models[modelName] = {};\n        for (var staticmethodName in modelDef.staticmethods) {\n            var url = modelDef.staticmethods[staticmethodName];\n            /* url should be either '' or 'GET /someurl' format. */\n            var remoteFn;\n            if (url === '') {\n                remoteFn = remoteFnFactory('POST', '/api/' + modelName + '/' + staticmethodName);\n            } else {\n                var toks = url.split(' '); // assert toks.length == 2\n                remoteFn = remoteFnFactory(toks[0], toks.substr(1).join(' '));\n            }\n            models[modelName][staticmethodName] = remoteFn;\n        }\n    }\n\n    return models;\n\n\n})(jQuery, modelDefs);\n"
    }
  },
  "models": {
    "Picture": {
      "fields": {
        "datePicked": "Date",
        "name": "String",
        "url": "String"
      },
      "instancemethods": {
        "updateUrl": "function (newUrl, cb) {\n      this.url = newUrl;\n      this.save(function(e, d){cb(e,d);});\n    }"
      },
      "staticmethods": {
        "randomNFromFlickr": "function (searchQ, limit, cb) {\n      var flickr = require('flickr');\n      var fcli = new flickr.Flickr('cbe3f7f6cbf9d13ad243a1e1afec902d', '5c3f9a33e088ef60');\n      fcli.executeAPIRequest('flickr.photos.search', {text: searchQ, per_page: limit, extras: ['url_q']},\n                               false, function(e, d){cb(e, d);});\n    }"
      }
    }
  },
  "templates": {
    "Homepage": {
      "generate": "templates.page",
      "data": {
        "head": "",
        "body": {
          "generate": "templates.concatUIE",
          "data": [
            {
              "html": "\n    <h1>FlickrPickr</h1>\n    ",
              "js": "",
              "css": ""
            },
            {
              "generate": "flickrpickr.uielements.flicksearchbar",
              "data": {
                "galleryID": "myflickgallery",
                "searchID": "myflicksearch",
                "buttonText": "Hit the backend!"
              }
            },
            {
              "generate": "flickrpickr.uielements.flickgallery",
              "data": {
                "galleryID": "myflickgallery"
              }
            },
            {
              "html": "<form id=\"testform\">\n    <input type=\"text\" name=\"name\" placeholder=\"name\"><br>\n    <input type=\"text\" name=\"url\" placeholder=\"url\"><br>\n    <input type=\"button\" value=\"Submit\"><br>\n    </form>\n    <span id=\"#testformloading\" style=\"visibility:hidden\">Loading...</span>\n    <span id=\"#testformok\" style=\"visibility:hidden\">OK</div>\n\n    ",
              "js": "$('#testform input[type=\"button\"]').click(function(){\n    var formdata = $('#testform').getData();\n    models.Picture.create(formdata, function(err, data){\n        $('#testformloading').show();\n        if (err) { alert(err); }\n        else {\n            $('#testformloading').hide();\n            $('#testformok').show().delay(500).hide();\n        }\n    });\n});\n",
              "css": ""
            }
          ]
        }
      }
    },
    "modeldefs": "/* These are the public model api definitions.\n * Regenerate this client side based on what the user says are the public methods. */\nvar modelDefs = {\n    Picture: {\n        instancemethods: {'updateUrl': ''},\n        staticmethods: {'randomNFromFlickr': ''}\n    }\n};"
  },
  "routes": [
    {
      "generate": "routes.staticpage",
      "data": {
        "url": "/",
        "templateName": "Homepage"
      }
    },
    {
      "generate": "routes.apiroute",
      "data": {
        "modelName": "Picture",
        "methodName": "randomNFromFlickr"
      }
    }
  ],
  "generators": {
    "root": {},
    "flickrpickr": {
      "uielements": [
        {
          "name": "flicksearchbar",
          "version": "0.1",
          "code": "function (data, templates){\n        // buttonText, searchID, galleryID\n        var uie = {\n            html: templates.html(data),\n            css: '',\n            js: templates.js(data)\n        };\n        return uie;\n    }",
          "templates": {
            "html": "<form id=\"<%= searchID %>\">\n<input type=\"text\" name=\"q\">\n<input type=\"submit\" value=\"<%= buttonText %>\">\n</form>",
            "js": "function renderInList (e, d) {    if (e) alert(e);    else {        for (var i = 0; i < d.photos.photo.length; i ++) {            var photo = d.photos.photo[i];            $('#<%= galleryID %>').append('<img src=\"'+photo.url_q+'\">');        }    }}$('#<%= searchID %>').submit(function() {    var formData = $('#<%= searchID %>').serializeArray();    models.Picture.randomNFromFlickr(formData[0].value, 10, renderInList);    return false;});"
          }
        },
        {
          "name": "flickgallery",
          "version": "0.1",
          "code": "function (data, templates){\n        // galleryID\n        var uie = {\n            html:'<div id=\"'+data.galleryID+'\"></div>',\n            css: '',\n            js: ''\n        };\n        return uie;\n    }",
          "templates": {}
        }
      ]
    }
  }
}