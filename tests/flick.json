{
  "packages": {
    "express": "3.4.4",
    "ejs": "0.8.5",
    "flickr": "0.1.0",
    "mongoose": "3.8.1"
  },
  "modules": {
    "custom": {
      "custom.txt": "this is custom code\n"
    }
  },
  "models": {
    "Picture": {
      "fields": {
        "datePicked": "Date",
        "url": "String"
      },
      "instancemethods": {
        "updateUrl": "function (newUrl, cb) {\n      this.url = newUrl;\n      this.save(function(e, d){cb(e,d);});\n    }"
      },
      "staticmethods": {
        "randomNFromFlickr": "function (searchQ, limit, cb) {\n      var flickr = require('flickr');\n      var fcli = new flickr.Flickr('cbe3f7f6cbf9d13ad243a1e1afec902d', '5c3f9a33e088ef60');\n      fcli.executeAPIRequest('flickr.photos.search', {text: searchQ, per_page: limit, extras: ['url_q']},\n                               false, function(e, d){cb(e, d);});\n    }"
      }
    }
  },
  "templates": {
    "Homepage": [
      {
        "html": "\n    <h1>FlickrPickr</h1>\n    ",
        "js": "",
        "css": ""
      },
      {
        "html": "\n<script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js\"></script>\n",
        "js": "",
        "css": ""
      },
      {
        "generate": "flickrpickr.uielements.flicksearchbar",
        "data": {
          "galleryID": "myflickgallery",
          "searchID": "myflicksearch",
          "buttonText": "Hit the backend!"
        }
      },
      {
        "generate": "flickrpickr.uielements.flickgallery",
        "data": {
          "galleryID": "myflickgallery"
        }
      }
    ]
  },
  "routes": [
    {
      "generate": "routes.staticpage",
      "data": {
        "url": "/",
        "templateName": "Homepage"
      }
    },
    {
      "method": "POST",
      "pattern": "/randomNFromFlickr",
      "code": "function (req, res) {\n        var P = require('./models/Picture').Picture;\n        var whenDone = function(e, d) { res.send({error:e, data:d}); };\n        var args = req.body.args;\n        args.push(whenDone);\n        P.randomNFromFlickr.apply(P, args);\n    }"
    }
  ],
  "generators": {
    "root": {},
    "flickrpickr": {
      "uielements": [
        {
          "name": "flicksearchbar",
          "version": "0.1",
          "code": "function (data, templates){\n        // buttonText, searchID, galleryID\n        var uie = {\n            html: templates.html(data),\n            css: '',\n            js: templates.js(data)\n        };\n        return uie;\n    }",
          "templates": {
            "html": "<form id=\"<%= searchID %>\">\n<input type=\"text\" name=\"q\">\n<input type=\"submit\" value=\"<%= buttonText %>\">\n</form>",
            "js": "var models={};models.Picture={};models.Picture.randomNFromFlickr = function(arg1, arg2, callback) {    $.ajax({        url: '/randomNFromFlickr',        method: 'POST',        data: {'args[0]':arg1, 'args[1]':arg2 },        success: function(res) {callback(res.error, res.data);}    });};function renderInList (e, d) {    if (e) alert(e);    else {        for (var i = 0; i < d.photos.photo.length; i ++) {            var photo = d.photos.photo[i];            $('#<%= galleryID %>').append('<img src=\"'+photo.url_q+'\">');        }    }}$('#<%= searchID %>').submit(function() {    var formData = $('#<%= searchID %>').serializeArray();    models.Picture.randomNFromFlickr(formData[0].value, 10, renderInList);    return false;});"
          }
        },
        {
          "name": "flickgallery",
          "version": "0.1",
          "code": "function (data, templates){\n        // galleryID\n        var uie = {\n            html:'<div id=\"'+data.galleryID+'\"></div>',\n            css: '',\n            js: ''\n        };\n        return uie;\n    }",
          "templates": {}
        }
      ]
    }
  }
}